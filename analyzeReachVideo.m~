function analyzeReachVideo(videoFile,discardFirstNFrames)
% Note that matching Arduino output data file should be named 'OUTPUT.txt'
% and in same directory as videoFile

% Check the following files before running this code.
% These files determine the settings to be used for the analysis.
% setup_reach_coding_settings.m
% autoReachAnalysisSettings.m
% alignmentSettings.m
% arduinoSettings.m


endofVfname=regexp(videoFile,'\.');

%% Get user-defined movie zones
setup_reach_coding(videoFile,discardFirstNFrames);

%% Read data from user-defined zones
[out,zoneVals,reaches,pellets,eat,paw,fidget,settings]=extractEventsFromMovie([videoFile(1:endofVfname(end)-1) '_zones.mat'],videoFile,[]);

%% Re-format movie data as events
savehandles=reformatAutoClassifyOutput(out,zoneVals,reaches,pellets,eat,paw,fidget,settings);

%% Get Arduino output data
out=parseSerialOut_wrapper([videoFile(1:endofVfname(end)) 'OUTPUT.txt'],[videoFile(1:endofVfname(end)) 'parsedOutput.mat']);

%% Align Arduino output data and data from video file
aligned=getAlignment(out,30,savehandles);

%% Put Arduino output data and data from video file together    
[status]=mkdir([videoFile(1:endofVfname(end)-1) '_processed_data']);
finaldata=integrateSDoutWithReaches(savehandles,out,30,aligned,[videoFile(1:endofVfname(end)-1) '_processed_data']);  
     
%% Plot results
tbt=plotCueTriggeredBehavior(finaldata,'cue',1);
save([videoFile(1:endofVfname(end)-1) '_processed_data\tbt.mat'],'tbt');

end